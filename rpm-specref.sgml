<appendix id="ch-rpm-specref">
  <title>Concise Spec File Reference</title>

  <indexterm>
    <primary>spec file</primary>
    <secondary>contents of</secondary>
  </indexterm>

  <sect1 id="s1-rpm-specref-comments">
    <title>Comments</title>

    <indexterm>
      <primary>spec file</primary>
      <secondary>comments in</secondary>
    </indexterm>

    <para>
      Comments are a way to make RPM ignore a line in the spec file.  To create
      a comment, enter an octothorp (<literal>#</literal>) at the start of the
      line.  Any text following the comment character will be ignored by RPM:

      <screen width="60">
<computeroutput>
# This is the spec file for playmidi 2.3...
</computeroutput>
      </screen>
    </para>

    <para>
      Comments can be placed in any section of the spec file.
    </para>

    <para>
      See also: <xref linkend="s1-rpm-inside-comments">.
    </para>
  </sect1>

  <sect1 id="s1-rpm-specref-preamble">
    <title>The Preamble</title>

    <para>
      This section outlines the tags that comprise a spec file's preamble.
    </para>

    <sect2 id="s2-rpm-specref-package-naming-tags">
      <title>Package Naming Tags</title>

      <para>
        This section outlines the tags that are used to name a package.
      </para>

      <sect3 id="s3-rpm-specref-name">
        <title>The <command>Name:</command> Tag</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>tags in</secondary>
          <tertiary><command>Name:</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>Name:</command> tag</primary>
        </indexterm>

        <para>
          The <command>Name:</command> tag is used to define the name of the
          software being packaged.

          <screen width="60">
<computeroutput>
Name: cdplayer
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-name-tag">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-version">
        <title>The <command>Version:</command> Tag</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>tags in</secondary>
          <tertiary><command>Version:</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>Version:</command> tag</primary>
        </indexterm>

        <para>
          The <command>Version:</command> tag defines the version of the software
          being packaged.

          <screen width="60">
<computeroutput>
Version: 1.2
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-version-tag">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-release">
        <title>The <command>Release:</command> Tag</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>tags in</secondary>
          <tertiary><command>Release:</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>Release:</command> tag</primary>
        </indexterm>

        <para>
          The <command>Release:</command> tag can be thought of as the
          <emphasis>package's</emphasis> version.

          <screen width="60">
<computeroutput>
Release: 5
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-release-tag">.
        </para>
      </sect3>
    </sect2>

    <sect2 id="s2-rpm-specref-descriptive-tags">
      <title>Descriptive Tags</title>

      <sect3 id="s3-rpm-specref-description">
        <title><command>%description</command> Directive -- Describe the packages intended use.
	</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>tags in</secondary>
          <tertiary><command>%description</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>%description</command> tag</primary>
        </indexterm>

        <para>
          The <command>%description</command> tag is used to define an in-depth
          description of the packaged software.  In the descriptive text, a
          space in the first column indicates that that line of text should be
          presented to user as-is, with no formatting done by RPM.  Blank lines
          in the descriptive text denote paragraphs.

          <screen width="60">
<computeroutput>
%description
 It slices!
 It dices!
 It's a CD player app that can't be beat.

By using the resonant frequency of the CD itself, it is able to simulate
20X oversampling.  This leads to sound quality that cannot be equaled with
more mundane software...
</computeroutput>
          </screen>
        </para>

        <para>
          The <command>%description</command> tag can be made specific to a
          particular subpackage by adding the subpackage name, and optionally,
          the <option>-n</option> option:

          <screen width="60">
<computeroutput>
%description bar

%description -n bar
</computeroutput>
          </screen>
        </para>

        <para>
          The subpackage name and usage of the <option>-n</option> option must
          match those defined with the <command>%package</command> directive.
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-description-tag">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-summary">
        <title>The <command>Summary:</command> Tag
	</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>tags in</secondary>
          <tertiary><command>Summary:</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>Summary:</command> tag</primary>
        </indexterm>

        <para>
          The <command>Summary:</command> tag is used to define a one-line
          description of the packaged software.

          <screen width="60">
<computeroutput>
Summary: A CD player app that rocks!
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-summary-tag">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-copyright">
        <title>The <command>Copyright:</command> Tag
	</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>tags in</secondary>
          <tertiary><command>Copyright:</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>Copyright:</command> tag</primary>
        </indexterm>

        <para>
          The <command>Copyright:</command> tag is used to define the copyright
          terms applicable to the software being packaged.

          <screen width="60">
<computeroutput>
Copyright: GPL
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-copyright-tag">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-distribution">
        <title>The <command>Distribution:</command> Tag</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>tags in</secondary>
          <tertiary><command>Distribution:</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>Distribution:</command> tag</primary>
        </indexterm>

        <para>
          The <command>Distribution:</command> tag is used to define a group of
          packages, of which this package is a part.

          <screen width="60">
<computeroutput>
Distribution: Doors '95
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-distribution-tag">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-icon">
        <title>The <command>Icon:</command> Tag</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>tags in</secondary>
          <tertiary><command>Icon:</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>Icon:</command> tag</primary>
        </indexterm>

        <para>
          The <command>Icon:</command> tag is used to name a file containing an
          icon representing the packaged software.  The file may be in either
          GIF or XPM format, although XPM is preferred.  In either case, the
          background of the icon should be transparent.

          <screen width="60">
<computeroutput>
Icon: foo.xpm
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-icon-tag">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-vendor">
        <title>The <command>Vendor:</command> Tag</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>tags in</secondary>
          <tertiary><command>Vendor:</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>Vendor:</command> tag</primary>
        </indexterm>

        <para>
          The <command>Vendor:</command> tag is used to define the name of the
          entity that is responsible for packaging the software.

          <screen width="60">
<computeroutput>
Vendor: White Socks Software, Inc.
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-vendor-tag">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-url">
        <title>The <command>URL:</command> Tag</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>tags in</secondary>
          <tertiary><command>URL:</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>URL:</command> tag</primary>
        </indexterm>

        <para>
          The <command>URL:</command> tag is used to define a Uniform Resource
          Locator that can be used to obtain additional information about the
          packaged software.

          <screen width="60">
<computeroutput>
URL: http://www.gnomovision.com/cdplayer.html
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-url-tag">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-group">
        <title>The <command>Group:</command> Tag</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>tags in</secondary>
          <tertiary><command>Group:</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>Group:</command> tag</primary>
        </indexterm>

        <para>
          The <command>Group:</command> tag is used to group packages together by
          the types of functionality they provide.

          <screen width="60">
<computeroutput>
Group: Applications/Editors
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-group-tag">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-packager">
        <title>The <command>Packager:</command> Tag</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>tags in</secondary>
          <tertiary><command>Packager:</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>Packager:</command> tag</primary>
        </indexterm>

        <para>
          The <command>Packager:</command> tag is used to hold the name and
          contact information for the person or persons who built the package.

          <screen width="60">
<computeroutput>
Packager: Fred Foonly &lt;fred@gnomovision.com&gt;
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-packager-tag">.
        </para>
      </sect3>
    </sect2>

    <sect2 id="s2-rpm-specref-dependency-tags">
      <title>Dependency Tags</title>

      <sect3 id="s3-rpm-specref-provides">
        <title>The <command>Provides:</command> Tag</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>tags in</secondary>
          <tertiary><command>Provides:</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>Provides:</command> tag</primary>
        </indexterm>

        <para>
          The <command>Provides:</command> tag is used to specify a "virtual
          package" that the packaged software makes available when it is
          installed.

          <screen width="60">
<computeroutput>
Provides: module-info
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-provides-tag">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-requires">
        <title>The <command>Requires:</command> Tag</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>tags in</secondary>
          <tertiary><command>Requires:</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>Requires:</command> tag</primary>
        </indexterm>

        <para>
          The <command>Requires:</command> tag is used to alert RPM to the fact
          that the package needs to have certain capabilities available in order
          to operate properly.

          <screen width="60">
<computeroutput>
Requires: playmidi
</computeroutput>
          </screen>
        </para>

        <para>
          A version may be specified, following the package specification.  The
          following comparison operators may be placed between the package and
          version:

          <screen width="60">
<computeroutput>
&lt;, &gt;, =, &gt;=, or &lt;=
</computeroutput>
          </screen>
        </para>

        <para>
          <screen width="60">
<computeroutput>
Requires: playmidi &gt;= 2.3
</computeroutput>
          </screen>
        </para>

        <para>
          If the <command>Requires:</command> tag needs to perform a comparison
          against a serial numbered defined with the <command>Serial:</command>
          tag, then the proper format would be:

          <screen width="60">
<computeroutput>
Requires: playmidi =S 4
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-requires-tag">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-serial">
        <title>The <command>Serial:</command> Tag</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>tags in</secondary>
          <tertiary><command>Serial:</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>Serial:</command> tag</primary>
        </indexterm>

        <para>
          The <command>Serial:</command> tag is used to define a serial number
          for a package.  This is only necessary if RPM is unable to determine
          the ordering of a package's version numbers.

          <screen width="60">
<computeroutput>
Serial: 4
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-serial-tag">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-conflicts">
        <title>The <command>Conflicts:</command> Tag</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>tags in</secondary>
          <tertiary><command>Conflicts:</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>Conflicts:</command> tag</primary>
        </indexterm>

        <para>
          The <command>Conflicts:</command> tag is used to alert RPM to the fact
          that the package is not compatible with other packages.

          <screen width="60">
<computeroutput>
Conflicts: playmidi
</computeroutput>
          </screen>
        </para>

        <para>
          A version may be specified, following the package specification.  The
          following comparison operators may be placed between the package and
          version:

          <screen width="60">
<computeroutput>
&lt;, &gt;, =, &gt;=, or &lt;=
</computeroutput>
          </screen>
        </para>

        <para>
          <screen width="60">
<computeroutput>
Conflicts: playmidi &gt;= 2.3
</computeroutput>
          </screen>
        </para>

        <para>
          If the <command>Conflicts:</command> tag needs to perform a comparison
          against a serial numbered defined with the <command>Serial:</command>
          tag, then the proper format would be:

          <screen width="60">
<computeroutput>
Conflicts: playmidi =S 4
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-conflicts-tag">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-autoreqprov">
        <title>The <command>AutoReqProv:</command> Tag</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>tags in</secondary>
          <tertiary><command>AutoReqProv:</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>AutoReqProv:</command> tag</primary>
        </indexterm>

        <para>
          The <command>AutoReqProv:</command> tag is used to control the
          automatic dependency processing performed when the package is being
          built.  To disable automatic dependency processing, add the following
          line:

          <screen width="60">
<computeroutput>
AutoReqProv: no
</computeroutput>
          </screen>
        </para>

        <para>
          (The number <literal>0</literal> may be used instead of
          <literal>no</literal>) Although RPM defaults to performing automatic
          dependency processing, the effect of the
          <command>AutoReqProv:</command> tag can be reversed by changing
          <literal>no</literal> to <literal>yes</literal>.  (The number
          <literal>1</literal> may be used instead of <literal>yes</literal>)
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-autoreqprov-tag">.
        </para>
      </sect3>
    </sect2>

    <sect2 id="s2-rpm-specref-arch-os-specific-tag">
      <title>Architecture- and Operating System-Specific Tags</title>

      <sect3 id="s3-rpm-specref-excludearch">
        <title>The <command>ExcludeArch:</command> Tag</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>tags in</secondary>
          <tertiary><command>ExcludeArch:</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>ExcludeArch:</command> tag</primary>
        </indexterm>

        <para>
          The <command>ExcludeArch:</command> tag is used to direct RPM to ensure
          that the package does <emphasis>not</emphasis> attempt to build on the
          excluded architecture(s).

          <screen width="60">
<computeroutput>
ExcludeArch: sparc alpha
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-excludearch-tag">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-exclusivearch">
        <title>The <command>ExclusiveArch:</command> Tag</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>tags in</secondary>
          <tertiary><command>ExclusiveArch:</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>ExclusiveArch:</command> tag</primary>
        </indexterm>

        <para>
          The <command>ExclusiveArch:</command> tag is used to direct RPM to
          ensure the package is <emphasis>only</emphasis> built on the specified
          architecture(s).

          <screen width="60">
<computeroutput>
ExclusiveArch: sparc alpha
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-exclusivearch-tag">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-excludeos">
        <title>The <command>ExcludeOs:</command> Tag</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>tags in</secondary>
          <tertiary><command>ExcludeOs:</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>ExcludeOs:</command> tag</primary>
        </indexterm>

        <para>
          The <command>ExcludeOs:</command> tag is used to direct RPM to ensure
          that the package does <emphasis>not</emphasis> attempt to build on the
          excluded operating system(s).

          <screen width="60">
<computeroutput>
ExcludeOS: linux irix
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-excludeos">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-exclusiveos">
        <title>The <command>ExclusiveOs:</command> Tag</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>tags in</secondary>
          <tertiary><command>ExclusiveOs:</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>ExclusiveOs:</command> tag</primary>
        </indexterm>

        <para>
          The <command>ExclusiveOs:</command> tag is used to denote which
          operating system(s) should <emphasis>only</emphasis> be be permitted
          to build the package.

          <screen width="60">
<computeroutput>
ExclusiveOS: linux
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-exclusiveos-tag">.
        </para>
      </sect3>
    </sect2>

    <sect2 id="s2-rpm-specref-directory-related-tags">
      <title>Directory-related Tags</title>

      <sect3 id="s3-rpm-specref-prefix">
        <title>The <command>Prefix:</command> Tag</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>tags in</secondary>
          <tertiary><command>Prefix:</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>Prefix:</command> tag</primary>
        </indexterm>

        <para>
          The <command>Prefix:</command> tag is used to define part of the path
          RPM will use when installing the package's files.  The prefix can be
          redefined by the user when the package is installed, thereby changing
          where the package is installed.

          <screen width="60">
<computeroutput>
Prefix: /opt
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-prefix-tag">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-buildroot">
        <title>The <command>BuildRoot:</command> Tag</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>tags in</secondary>
          <tertiary><command>BuildRoot:</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>BuildRoot:</command> tag</primary>
        </indexterm>

        <para>
          The <command>BuildRoot:</command> tag is used to define an alternate
          build root, where the software will be installed during the build
          process.

          <screen width="60">
<computeroutput>
BuildRoot: /tmp/cdplayer
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-buildroot-tag">.
        </para>
      </sect3>
    </sect2>

    <sect2 id="s2-rpm-specref-source-patch-tags">
      <title>Source and Patch Tags</title>

      <sect3 id="s3-rpm-specref-source">
        <title>The <command>Source:</command> Tag</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>tags in</secondary>
          <tertiary><command>Source:</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>Source:</command> tag</primary>
        </indexterm>

        <para>
          The <command>Source:</command> tag is used to define the filename of
          the sources to be packaged.  When there is more than one
          <command>Source:</command> tag in a spec file, each one must be
          numbered so they are unique, starting with the number
          <literal>0</literal>.  When there is only one tag, it does not need to
          be numbered.
        </para>

        <para>
          By convention, the source filename is usually preceded by a URL
          pointing to the location of the original sources, but RPM does not
          require this.

          <screen width="60">
<computeroutput>
Source0: ftp://ftp.gnomovision.com/pub/cdplayer-1.0.tgz
Source1: foo.tgz
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-source-tag">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-nosource">
        <title>The <command>NoSource:</command> Tag</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>tags in</secondary>
          <tertiary><command>NoSource:</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>NoSource:</command> tag</primary>
        </indexterm>

        <para>
          The <command>NoSource:</command> tag is used to alert RPM to the fact
          that one or more source files should be excluded from the source
          package file.  The tag is followed by one or more numbers.  The
          numbers correspond to the numbers following the
          <command>Source:</command> tags that are to be excluded from packaging.

          <screen width="60">
<computeroutput>
NoSource: 0, 3
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-nosource-tag">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-patch">
        <title>The <command>Patch:</command> Tag</title>

        <indexterm>
          <primary><command>Patch:</command> tag</primary>
        </indexterm>

        <para>
          The <command>Patch:</command> tag is used to define the name of a patch
          file to be applied to the package's sources.  When there is more than
          one <command>Patch:</command> tag in a spec file, each one must be
          numbered so they are unique, starting with the number
          <literal>0</literal>.  When there is only one tag, it does not need to
          be numbered.

          <screen width="60">
<computeroutput>
Patch: cdp-0.33-fsstnd.patch
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-patch-tag">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-nopatch">
        <title>The <command>NoPatch:</command> Tag</title>

        <indexterm>
          <primary><command>NoPatch:</command> tag</primary>
        </indexterm>

        <para>
          The <command>NoPatch:</command> tag is used to alert RPM to the fact
          that one or more patch files should be excluded from the source
          package file.  The tag is followed by one or more numbers.  The
          numbers correspond to the numbers following the
          <command>Patch:</command> tags that are to be excluded from packaging.

          <screen width="60">
<computeroutput>
NoPatch: 2 3
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-nopatch-tag">.
        </para>
      </sect3>
    </sect2>
  </sect1>

  <sect1 id="s1-rpm-specref-scripts">
    <title>Scriptlets</title>

    <para>
      This section lists the various scriptlets found in a spec file.
    </para>

    <sect2 id="s2-rpm-specref-build-time-scripts">
      <title>Build Scriptlets</title>

      <para>
        Every build scriptlet has the following environment variables defined:

        <itemizedlist mark="bullet">
          <listitem>
            <para>
              <envar>RPM_SOURCE_DIR</envar>
            </para>
          </listitem>

          <listitem>
            <para>
              <envar>RPM_BUILD_DIR</envar>
            </para>
          </listitem>

          <listitem>
            <para>
              <envar>RPM_DOC_DIR</envar>
            </para>
          </listitem>

          <listitem>
            <para>
              <envar>RPM_OPT_FLAGS</envar>
            </para>
          </listitem>

          <listitem>
            <para>
              <envar>RPM_ARCH</envar>
            </para>
          </listitem>

          <listitem>
            <para>
              <envar>RPM_OS</envar>
            </para>
          </listitem>

          <listitem>
            <para>
              <envar>RPM_ROOT_DIR</envar>
            </para>
          </listitem>

          <listitem>
            <para>
              <envar>RPM_BUILD_ROOT</envar>
            </para>
          </listitem>

          <listitem>
            <para>
              <envar>RPM_PACKAGE_NAME</envar>
            </para>
          </listitem>

          <listitem>
            <para>
              <envar>RPM_PACKAGE_VERSION</envar>
            </para>
          </listitem>

          <listitem>
            <para>
              <envar>RPM_PACKAGE_RELEASE</envar>
            </para>
          </listitem>
        </itemizedlist>
      </para>

      <para>
        For more information on these environment variables, and build
        scriptlets in general, please see <xref
        linkend="s2-rpm-inside-build-time-scripts">.
      </para>

      <sect3 id="s3-rpm-specref-prep">
        <title><command>%prep</command> Directive -- Unpack archives and apply patches.
	</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>scriptlets</secondary>
          <tertiary><command>%prep</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>%prep</command> scriptlet</primary>
        </indexterm>

        <para>
          The <command>%prep</command> scriptlet is executed first
          during a build,
	  The scriptlet normally prepares the contents of a source package
	  for building, usually by unpacking archives and applying patches.
The scriptlet can contain any valid <command>sh</command> commands.

          <screen width="60">
<computeroutput>
%prep
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-prep-script">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-build">
        <title><command>%build</command> Directive -- Configure and compile components
	to be packaged.
	</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>scriptlets</secondary>
          <tertiary><command>%build</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>%build</command> scriptlet</primary>
        </indexterm>

        <para>
          The <command>%build</command> scriptlet is the second scriptlet
	  executed during a build, immediately after <command>%prep</command>.
	  The scriptlet normally builds the components to be included in
	  a binary package, usually by configuring and compiling source code
	  from the previously unpacked and patched archives.
The scriptlet can contain any valid <command>sh</command> commands.

          <screen width="60">
<computeroutput>
%build
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-build-script">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-install">
        <title><command>%install</command> Directive -- Install components to be packaged.
	</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>scriptlets</secondary>
          <tertiary><command>%install</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>%install</command> scriptlet</primary>
        </indexterm>

        <para>
          The <command>%install</command> scriptlet is the third scriptlet
          executed during a build, immediately after <command>%build</command>.
	  The scriptlet normally installs components to be included in
	  a binary package, usually by copying files from the build directory
	  tree to an install directory tree.
The scriptlet can contain any valid <command>sh</command> commands.

          <screen width="60">
<computeroutput>
%install
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-install-script">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-clean">
        <title><command>%clean</command> Directive -- Remove build components.
	</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>scriptlets</secondary>
          <tertiary><command>%clean</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>%clean</command> scriptlet</primary>
        </indexterm>

        <para>
          The <command>%clean</command> scriptlet is executed at the end of
	  a build.
	  The scriptlet cleans up files produced during a build, usually by
	  removing the install directory tree.
The scriptlet can contain any valid <command>sh</command> commands.

          <screen width="60">
<computeroutput>
%clean
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-clean-script">.
        </para>
      </sect3>
    </sect2>

    <sect2 id="s2-rpm-specref-install-erase-scripts">
      <title>Install/Erase Scriptlets</title>

      <para>
        These scriptlets are executed whenever the package is installed or
	erased.
Each scriptlet can contain any valid <command>sh</command> commands.
      </para>

      <para>
        Note: Each of the following scriptlet can be made specific to a
	particular subpackage by adding the subpackage name, and optionally,
	the <option>-n</option> option:

        <screen width="60">
<computeroutput>
%post bar

%preun -n bar
</computeroutput>
        </screen>
      </para>

      <para>
        The subpackage name and usage of the <option>-n</option> option must
        match those defined with the <command>%package</command> directive.
      </para>

      <para>
        Each scriptlet has the following environment variable defined:

        <itemizedlist mark="bullet">
          <listitem>
            <para>
              <envar>RPM_INSTALL_PREFIX</envar>
            </para>
          </listitem>
        </itemizedlist>
      </para>

      <para>
        For more information on this environment variable please see <xref
        linkend="s2-rpm-inside-erase-time-scripts">.
      </para>

      <sect3 id="s3-rpm-specref-pre">
        <title>The <command>%pre</command> Script</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>scriptlets</secondary>
          <tertiary><command>%pre</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>%pre</command> scriptlet</primary>
        </indexterm>

        <para>
          The <command>%pre</command> scriptlet executes just before the package is
          to be installed.

          <screen width="60">
<computeroutput>
%pre
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-pre-script">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-post">
        <title>The <command>%post</command> Script</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>scriptlets</secondary>
          <tertiary><command>%post</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>%post</command> scriptlet</primary>
        </indexterm>

        <para>
          The <command>%post</command> scriptlet executes just after the package is
          to be installed.

          <screen width="60">
<computeroutput>
%post
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s4-rpm-inside-post-script">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-preun">
        <title>The <command>%preun</command> Script</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>scriptlets</secondary>
          <tertiary><command>%preun</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>%preun</command> scriptlet</primary>
        </indexterm>

        <para>
          The <command>%preun</command> scriptlet executes just before the package
          is to be erased.

          <screen width="60">
<computeroutput>
%preun
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-preun-script">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-postun">
        <title><command>%postun</command> Directive</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>scriptlets</secondary>
          <tertiary><command>%postun</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>%postun</command> scriptlet</primary>
        </indexterm>

        <para>
          The <command>%postun</command> scriptlet executes just after the package
          is to be erased.

          <screen width="60">
<computeroutput>
%postun
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-postun-script">.
        </para>
      </sect3>
    </sect2>

    <sect2 id="s2-rpm-specref-verification-script">
	<title><command>%verifyscript</command> Directive
	</title>

      <para>
        This section describes the verification script.
      </para>

      <sect3 id="s3-rpm-specref-verifyscript">
        <title>The <command>%verifyscript</command> Script</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>scriptlets</secondary>
          <tertiary><command>%verifyscript</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>%verifyscript</command> scriptlet</primary>
        </indexterm>

        <para>
          The <command>%verifyscript</command> scriptlet executes whenever the
          package is verified using RPM's <option>-V</option> option.
The scriptlet can contain any valid <command>sh</command> commands.
        </para>

        <para>
          See also: <xref linkend="s2-rpm-inside-verifyscript-script">.
        </para>
      </sect3>
    </sect2>
  </sect1>

  <sect1 id="s1-rpm-specref-macros">
    <title>Macros</title>

    <para>
      This section describes the various macros used by RPM.
    </para>

    <sect2 id="s2-rpm-specref-setup">
      <title>The <command>%setup</command> Macro</title>

      <indexterm>
        <primary>spec file</primary>
        <secondary>macros in</secondary>
        <tertiary><command>%setup</command></tertiary>
      </indexterm>

      <indexterm>
        <primary><command>%setup</command> macro</primary>
      </indexterm>

      <para>
        The <command>%setup</command> macro is used to unpack the original
        sources in preparation for the build.  It is used in the
        <command>%prep</command> script:

        <screen width="60">
<computeroutput>
%prep
%setup
</computeroutput>
        </screen>
      </para>

      <para>
        See also: <xref linkend="s2-rpm-inside-setup-macro">.
      </para>

      <sect3 id="s3-rpm-specref-setup-n-option">
        <title>
          The <option>-n <replaceable>&lt;name&gt;</replaceable></option>
          Option
        </title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>macros in</secondary>
          <tertiary><command>%setup</command>, options to</tertiary>
        </indexterm>

        <indexterm>
          <primary><command>%setup</command> macro</primary>
          <secondary>options to</secondary>
        </indexterm>

        <para>
          The <option>-n</option> option is used to set the name of the
          software's build directory.  This is necessary only when the source
          archive unpacks into a directory named other than
          <command><replaceable>&lt;name&gt;</replaceable>-
          <replaceable>&lt;version&gt;</replaceable></command>.

          <screen width="60">
<computeroutput>
%setup -n cd-player
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-setup-n-option">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-setup-c-option">
        <title>The <option>-c</option> Option</title>

        <para>
          The <option>-c</option> option is used to direct
          <command>%setup</command> to create the top-level build directory
          before unpacking the sources.

          <screen width="60">
<computeroutput>
%setup -c
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-setup-c-option">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-setup-d-option">
        <title>The <option>-D</option> Option</title>

        <para>
          The <option>-D</option> option is used to direct
          <command>%setup</command> to not delete the build directory prior to
          unpacking the sources.  This option is used when more than one source
          archive is to be unpacked into the build directory, normally with the
          <option>-b</option> or <option>-a</option> options.

          <screen width="60">
<computeroutput>
%setup -D -T -b 3
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-setup-d-option">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-setup-t-option">
        <title>The <option>-T</option> Option</title>

        <para>
          The <option>-T</option> option is used to direct
          <command>%setup</command> to not perform the default unpacking of the
          source archive specified by the first <command>Source:</command> tag.
          It is used with the <option>-a</option> or <option>-b</option>
          options.

          <screen width="60">
<computeroutput>
%setup -D -T -a 1
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-setup-t-option">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-setup-b-option">
        <title>
          The <option>-b <replaceable>&lt;n&gt;</replaceable></option> Option
        </title>

        <para>
          The <option>-b</option> option is used to direct
          <command>%setup</command> to unpack the source archive specified on
          the <emphasis>n</emphasis>th <command>Source:</command> tag line before
          changing directory into the build directory.

          <screen width="60">
<computeroutput>
%setup -D -T -b 2
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-setup-b-option">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-setup-a-option">
        <title>
          The <option>-a <replaceable>&lt;n&gt;</replaceable></option> Option
        </title>

        <para>
          The <option>-a</option> option is used to direct
          <command>%setup</command> to unpack the source archive specified on
          the <emphasis>n</emphasis>th <command>Source:</command> tag line after
          changing directory into the build directory.

          <screen width="60">
<computeroutput>
%setup -D -T -a 5
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-setup-a-option">.
        </para>
      </sect3>
    </sect2>

    <sect2 id="s2-rpm-specref-patch-macro">
      <title>The <command>%patch</command> Macro</title>

      <indexterm>
        <primary>spec file</primary>
        <secondary>macros in</secondary>
        <tertiary><command>%patch</command></tertiary>
      </indexterm>

      <indexterm>
        <primary><command>%patch</command> macro</primary>
      </indexterm>

      <para>
        The <command>%patch</command> macro, as its name implies, is used to
        apply patches to the unpacked sources.  With no additional options
        specified, it will apply the patch file specified by the
        <command>Patch:</command> (or <command>Patch0:</command>) tag.

        <screen width="60">
<computeroutput>
%patch
</computeroutput>
        </screen>
      </para>

      <para>
        When there is more than one <command>Patch:</command> tag line in a spec
        file, they can be specified by appending the number of the
        <command>Patch:</command> tag to the <command>%patch</command> macro name
        itself.

        <screen width="60">
<computeroutput>
%patch2
</computeroutput>
        </screen>
      </para>

      <para>
        See also: <xref linkend="s2-rpm-inside-patch-macro">.
      </para>

      <sect3 id="s3-rpm-specref-patch-p-option">
        <title>
          The <option>-P <replaceable>&lt;n&gt;</replaceable></option> Option
        </title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>macros in</secondary>
          <tertiary><command>%patch</command>, options to</tertiary>
        </indexterm>

        <indexterm>
          <primary><command>%patch</command> macro</primary>
          <secondary>options to</secondary>
        </indexterm>

        <para>
          The <option>-P</option> option is another method of applying a
          specific patch.  The number from the <command>Patch:</command> tag
          follows the <option>-P</option> option.  The following
          <command>%patch</command> macros both apply the patch specified on the
          <command>Patch2:</command> tag line:

          <screen width="60">
<computeroutput>
%patch -P 2

%patch2
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-which-patch-tag">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-patch-p-option2">
        <title>
          The <option>-p<replaceable>&lt;#&gt;</replaceable></option> Option
        </title>

        <para>
          The <option>-p</option> option is sent directly to the
          <command>patch</command> command.  It is followed by a number which
          specifies the number of leading slashes (and the directories in
          between) to strip from any filenames present in the patch file.

          <screen width="60">
<computeroutput>
%patch -p2
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-patch-p-option">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-patch-b-option">
        <title>
          The <option>-b <replaceable>&lt;name&gt;</replaceable></option>
          Option
        </title>

        <para>
          When the <command>patch</command> command is used to apply a patch,
          unmodified copies of the files patched are renamed to end with the
          extension <filename>.orig</filename>.  The <option>-b</option>
          option is used to change the extension used by
          <command>patch</command>.

          <screen width="60">
<computeroutput>
%patch -b .fsstnd
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-b-option">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-patch-e-option">
        <title>The <command>%patch -E</command> Option</title>

        <para>
          The <option>-E</option> option is sent directly to the
          <command>patch</command> command.  It is used to direct
          <command>patch</command> to remove any empty files after the patches
          have been applied.
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-e-option">.
        </para>
      </sect3>
    </sect2>
  </sect1>

  <sect1 id="s1-rpm-specref-files-list">
    <title>The <command>%files</command> List</title>

    <indexterm>
      <primary>spec file</primary>
      <secondary><command>%files</command> list in</secondary>
    </indexterm>

    <para>
      The <command>%files</command> list indicates which files on the build
      system are to be packaged.  The list consists of one file per line.  If a
      directory is specified, by default all files and subdirectories will be
      packaged.

      <screen width="60">
<computeroutput>
%files
/etc/foo.conf
/sbin/foo
/usr/bin/foocmd
</computeroutput>
      </screen>
    </para>

    <para>
      The <command>%files</command> list can be made specific to a particular
      subpackage by adding the subpackage name, and optionally, the
      <option>-n</option> option:

      <screen width="60">
<computeroutput>
%files bar

%files -n bar
</computeroutput>
      </screen>
    </para>

    <para>
      The subpackage name and usage of the <option>-n</option> option must
      match those defined with the <command>%package</command> directive.
    </para>

    <para>
      The <command>%files</command> list can also use the contents of a file as
      the list of files to be packaged.  This is done by using the
      <option>-f</option> option, which is then followed by a filename:

      <screen width="60">
<computeroutput>
%files -f files.list
</computeroutput>
      </screen>
    </para>

    <para>
      See also: <xref linkend="s1-rpm-inside-files-list">.
    </para>
  </sect1>

  <sect1 id="s1-rpm-specref-files-list-directives">
    <title>Directives For the <command>%files</command> list</title>

    <para>
      This section lists the various directived used in the
      <command>%files</command> lists.
    </para>

    <sect2 id="s2-rpm-specref-file-related-directives">
      <title>File-related Directives</title>

      <para>
        This section lists those directives that are related to files.
      </para>

      <sect3 id="s3-rpm-specref-doc">
        <title>The <command>%doc</command> Directive</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>directives in</secondary>
          <tertiary><command>%doc</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>%doc</command> directive</primary>
        </indexterm>

        <para>
          The <command>%doc</command> directive flags the filename(s) that
          follow as being documentation.

          <screen width="60">
<computeroutput>
%doc README
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-flist-doc-directive">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-config">
        <title>The <command>%config</command> Directive</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>directives in</secondary>
          <tertiary><command>%config</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>%config</command> directive</primary>
        </indexterm>

        <para>
          The <command>%config</command> directive is used to flag the specified
          file as being a configuration file.

          <screen width="60">
<computeroutput>
%config /etc/fstab
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-flist-config-directive">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-attr">
        <title>The <command>%attr</command> Directive</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>directives in</secondary>
          <tertiary><command>%attr</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>%attr</command> directive</primary>
        </indexterm>

        <para>
          The <command>%attr</command> directive is used to permit RPM to
          directly control a file's permissions and ownership.  It is normally
          used when non-root users build packages.  The <command>%attr</command>
          directive has the following format:

          <screen width="60">
<computeroutput>
%attr(<replaceable>&lt;mode&gt;</replaceable>, <replaceable>&lt;user&gt;</replaceable>, <replaceable>&lt;group&gt;</replaceable>) <replaceable>file</replaceable>
</computeroutput>
          </screen>
        </para>

        <para>
          The user and group identifiers must be non-numeric.  Attributes that
          do not need to be set by <command>%attr</command> may be replaced with
          a dash:

          <screen width="60">
<computeroutput>
%attr(755, root, -) foo.bar
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-flist-attr-directive">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-verify">
        <title>The <command>%verify</command> Directive</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>directives in</secondary>
          <tertiary><command>%verify</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>%verify</command> directive</primary>
        </indexterm>

        <para>
          The <command>%verify</command> directive is used to control which of
          nine different file attributes are to be verified by RPM.  The
          attributes are:

          <orderedlist>
            <listitem>
              <para>
                <command>owner</command> &mdash; The file's owner.
              </para>
            </listitem>

            <listitem>
              <para>
                <command>group</command> &mdash; The file's group.
              </para>
            </listitem>

            <listitem>
              <para>
                <command>mode</command> &mdash; The file's mode.
              </para>
            </listitem>

            <listitem>
              <para>
                <command>md5</command> &mdash; The file's MD5 checksum.
              </para>
            </listitem>

            <listitem>
              <para>
                <command>size</command> &mdash; The file's size.
              </para>
            </listitem>

            <listitem>
              <para>
                <command>maj</command> &mdash; The file's major number.
              </para>
            </listitem>

            <listitem>
              <para>
                <command>min</command> &mdash; The file's minor number.
              </para>
            </listitem>

            <listitem>
              <para>
                <command>symlink</command> &mdash; The file's symbolic link
                string.
              </para>
            </listitem>

            <listitem>
              <para>
                <command>mtime</command> &mdash; The file's modification time.
              </para>
            </listitem>
          </orderedlist>
        </para>

        <para>
          If the keyword <command>not</command> precedes the list, every
          attribute <emphasis>except</emphasis> those listed will be verified.

          <screen width="60">
<computeroutput>
%verify(mode md5 size maj min symlink mtime) /dev/ttyS0
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-flist-verify-directive">.
        </para>
      </sect3>
    </sect2>

    <sect2 id="s2-rpm-specref-directory-related-directives">
      <title>Directory-related Directives</title>

      <sect3 id="s3-rpm-specref-docdir">
        <title>The <command>%docdir</command> Directive</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>directives in</secondary>
          <tertiary><command>%docdir</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>%docdir</command> directive</primary>
        </indexterm>

        <para>
          The <command>%docdir</command> directive is used to add the specified
          directory to RPM's internal list of directories containing
          documentation.  When a directory is added to this list, every file
          packaged in this directory (and any subdirectories) will automatically
          be marked as documentation.
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-docdir-directive">.
        </para>
      </sect3>

      <sect3 id="s3-rpm-specref-dir">
        <title>The <command>%dir</command> Directive</title>

        <indexterm>
          <primary>spec file</primary>
          <secondary>directives in</secondary>
          <tertiary><command>%dir</command></tertiary>
        </indexterm>

        <indexterm>
          <primary><command>%dir</command> directive</primary>
        </indexterm>

        <para>
          The <command>%dir</command> directive is used to direct RPM to package
          only the directory itself, regardless of what files may reside in the
          directory at the time the package is created.

          <screen width="60">
<computeroutput>
%dir /usr/blather
</computeroutput>
          </screen>
        </para>

        <para>
          See also: <xref linkend="s3-rpm-inside-dir-directive">.
        </para>
      </sect3>
    </sect2>
  </sect1>

  <sect1 id="s1-rpm-specref-package">
    <title><command>%package</command> Directive</title>

    <indexterm>
      <primary><command>%package</command> directive</primary>
    </indexterm>

    <para>
      The <command>%package</command> directive is used to control the creation
      of subpackages.  The subpackage name is derived from the first
      <command>Name:</command> tag in the spec file, followed by the name
      specified after the <command>%package</command> directive.  Therefore, if
      the first <command>Name:</command> tag is:

      <screen width="60">
<computeroutput>
Name: foo
</computeroutput>
      </screen>
    </para>

    <para>
      and a subpackage is defined with the following <command>%package</command>
      directive:

      <screen width="60">
<computeroutput>
%package bar
</computeroutput>
      </screen>
    </para>

    <para>
      the subpackage name will be <filename>foo-bar</filename>.
    </para>

    <para>
      See also: <xref linkend="s1-rpm-inside-package-directive">.
    </para>

    <sect2 id="s2-rpm-specref-package-n-option">
      <title>The <command>%package -n</command> Option</title>

      <indexterm>
        <primary>spec file</primary>
        <secondary>directives in</secondary>
        <tertiary><command>%package</command>, options to</tertiary>
      </indexterm>

      <indexterm>
        <primary><command>%package</command> directive</primary>
        <secondary><option>-n</option> option</secondary>
      </indexterm>

      <para>
        The <option>-n</option> option is used to change how RPM derives the
        subpackage name.  When the <option>-n</option> option is used, the
        name following the <command>%package</command> directive becomes the
        complete subpackage name.  Therefore, if a subpackage is defined with
        the following <command>%package</command> directive:

        <screen width="60">
<computeroutput>
%package -n bar
</computeroutput>
        </screen>
      </para>

      <para>
        the subpackage name will be <filename>bar</filename>.
      </para>

      <para>
        See also: <xref linkend="s2-rpm-inside-package-n-option">.
      </para>
    </sect2>
  </sect1>

  <sect1 id="s1-rpm-specref-conditionals">
    <title>Conditionals</title>

    <para>
      The <command>%if<replaceable>xxx</replaceable></command> conditionals are
      used to begin a section of the spec file that is specific to a particular
      architecture or operating system.  They are followed by one or more
      architecture or operating system specifiers, each separated by commas or
      whitespace.
    </para>

    <para>
      Conditionals may be nested within other conditionals, provided that the
      inner conditional is completely enclosed by the outer conditional.
    </para>

    <sect2 id="s2-rpm-specref-ifarch">
      <title>The <command>%ifarch</command> Conditional</title>

      <indexterm>
        <primary>spec file</primary>
        <secondary>conditionals in</secondary>
        <tertiary><command>%ifarch</command></tertiary>
      </indexterm>

      <indexterm>
        <primary><command>%ifarch</command> conditional</primary>
      </indexterm>

      <para>
        If the build system's architecture is specified, the part of the spec
        file following the <command>%ifarch</command>, but before a
        <command>%else</command> or <command>%endif</command> will be used
        during the build.

        <screen width="60">
<computeroutput>
%ifarch i386 sparc
</computeroutput>
        </screen>
      </para>

      <para>
        See also: <xref linkend="s2-rpm-inside-ifarch-conditional">.
      </para>
    </sect2>

    <sect2 id="s2-rpm-specref-ifnarch">
      <title>The <command>%ifnarch</command> Conditional</title>

      <indexterm>
        <primary>spec file</primary>
        <secondary>conditionals in</secondary>
        <tertiary><command>%ifnarch</command></tertiary>
      </indexterm>

      <indexterm>
        <primary><command>%ifnarch</command> conditional</primary>
      </indexterm>

      <para>
        If the build system's architecture is specified, the part of the spec
        file following the <command>%ifarch</command> but before a
        <command>%else</command> or <command>%endif</command> will
        <emphasis>not</emphasis> be used during the build.

        <screen width="60">
<computeroutput>
%ifnarch i386 sparc
</computeroutput>
        </screen>
      </para>

      <para>
        See also: <xref linkend="s2-rpm-inside-ifnarch-conditional">.
      </para>
    </sect2>

    <sect2 id="s2-rpm-specref-ifos">
      <title>The <command>%ifos</command> Conditional</title>

      <indexterm>
        <primary>spec file</primary>
        <secondary>conditionals in</secondary>
        <tertiary><command>%ifos</command></tertiary>
      </indexterm>

      <indexterm>
        <primary><command>%ifos</command> conditional</primary>
      </indexterm>

      <para>
        If the build system is running one of the specified operating systems,
        the part of the spec file following the <command>%ifos</command> but
        before a <command>%else</command> or <command>%endif</command> will be
        used during the build.

        <screen width="60">
<computeroutput>
%ifos linux
</computeroutput>
        </screen>
      </para>

      <para>
        See also: <xref linkend="s2-rpm-inside-ifos-conditional">.
      </para>
    </sect2>

    <sect2 id="s2-rpm-specref-ifnos">
      <title>The <command>%ifnos</command> Conditional</title>

      <indexterm>
        <primary>spec file</primary>
        <secondary>conditionals in</secondary>
        <tertiary><command>%ifnos</command></tertiary>
      </indexterm>

      <indexterm>
        <primary><command>%ifnos</command> conditional</primary>
      </indexterm>

      <para>
        If the build system is running one of the specified operating systems,
        the part of the spec file following the <command>%ifnos</command> but
        before a <command>%else</command> or <command>%endif</command> will
        <emphasis>not</emphasis> be used during the build.

        <screen width="60">
<computeroutput>
%ifnos linux
</computeroutput>
        </screen>
      </para>

      <para>
        See also: <xref linkend="s2-rpm-inside-ifnos-conditional">.
      </para>
    </sect2>

    <sect2 id="s2-rpm-specref-else">
      <title>The <command>%else</command> Conditional</title>

      <indexterm>
        <primary>spec file</primary>
        <secondary>conditionals in</secondary>
        <tertiary><command>%else</command></tertiary>
      </indexterm>

      <indexterm>
        <primary><command>%else</command> conditional</primary>
      </indexterm>

      <para>
        The <command>%else</command> conditional is placed between a
        <command>%if</command> conditional of some persuasion, and an
        <command>%endif</command>.  It is used to create two blocks of spec file
        statements, only one of which will be used in any given case.

        <screen width="60">
<computeroutput>
%ifarch alpha
make RPM_OPT_FLAGS="$RPM_OPT_FLAGS -I ."
%else
make RPM_OPT_FLAGS="$RPM_OPT_FLAGS"
%endif
</computeroutput>
        </screen>
      </para>

      <para>
        See also: <xref linkend="s2-rpm-inside-else-conditional">.
      </para>
    </sect2>

    <sect2 id="s2-rpm-specref-endif">
      <title>The <command>%endif</command> Conditional</title>

      <indexterm>
        <primary>spec file</primary>
        <secondary>conditionals in</secondary>
        <tertiary><command>%endif</command></tertiary>
      </indexterm>

      <indexterm>
        <primary><command>%endif</command> conditional</primary>
      </indexterm>

      <para>
        An <command>%endif</command> is used to end a conditional block of spec
        file statements.  The <command>%endif</command> is always needed after a
        conditional, otherwise, the build will fail.

        <screen width="60">
<computeroutput>
%ifarch i386
make INTELFLAG=-DINTEL
%endif
</computeroutput>
        </screen>
      </para>

      <para>
        See also: <xref linkend="s2-rpm-inside-endif-conditional">.
      </para>
    </sect2>
  </sect1>
</appendix>
